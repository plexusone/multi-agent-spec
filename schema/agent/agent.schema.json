{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/agentplexus/multi-agent-spec/main/schema/agent/agent.schema.json",
  "$ref": "#/$defs/Agent",
  "$defs": {
    "Agent": {
      "properties": {
        "name": {
          "type": "string"
        },
        "namespace": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "icon": {
          "type": "string"
        },
        "model": {
          "$ref": "#/$defs/Model"
        },
        "tools": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "allowedTools": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "skills": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "dependencies": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "requires": {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "instructions": {
          "type": "string"
        },
        "tasks": {
          "items": {
            "$ref": "#/$defs/Task"
          },
          "type": "array"
        },
        "role": {
          "type": "string",
          "description": "Agent's role title for self-directed workflows (e.g., 'Security Analyst')"
        },
        "goal": {
          "type": "string",
          "description": "What the agent aims to achieve in this role"
        },
        "backstory": {
          "type": "string",
          "description": "Context and background for the agent's role"
        },
        "delegation": {
          "$ref": "#/$defs/DelegationConfig"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "name"
      ]
    },
    "DelegationConfig": {
      "type": "object",
      "description": "Delegation permissions for self-directed workflows",
      "properties": {
        "allow_delegation": {
          "type": "boolean",
          "default": false,
          "description": "Whether this agent can delegate work to others"
        },
        "can_delegate_to": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Agent names this agent can delegate to (empty means no restrictions)"
        },
        "can_receive_from": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Agent names this agent can receive delegations from (empty means no restrictions)"
        }
      },
      "additionalProperties": false
    },
    "Model": {
      "type": "string",
      "enum": [
        "haiku",
        "sonnet",
        "opus"
      ],
      "description": "Model capability tier (mapped to platform-specific models)",
      "default": "sonnet"
    },
    "Task": {
      "properties": {
        "id": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "type": {
          "$ref": "#/$defs/TaskType"
        },
        "command": {
          "type": "string"
        },
        "pattern": {
          "type": "string"
        },
        "file": {
          "type": "string"
        },
        "files": {
          "type": "string"
        },
        "required": {
          "type": "boolean"
        },
        "expected_output": {
          "type": "string"
        },
        "human_in_loop": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "id"
      ]
    },
    "TaskType": {
      "type": "string",
      "enum": [
        "command",
        "pattern",
        "file",
        "manual"
      ],
      "description": "How the task is executed",
      "default": "manual"
    }
  },
  "title": "Multi-Agent Spec - Agent Definition",
  "description": "Schema for defining an AI agent in a multi-agent system"
}