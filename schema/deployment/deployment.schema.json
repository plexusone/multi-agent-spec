{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/agentplexus/multi-agent-spec/main/schema/deployment/deployment.schema.json",
  "$ref": "#/$defs/Deployment",
  "$defs": {
    "ADKGoConfig": {
      "properties": {
        "model": {
          "type": "string"
        },
        "serverPort": {
          "type": "integer"
        },
        "sessionStore": {
          "type": "string"
        },
        "toolRegistry": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "AWSAgentCoreConfig": {
      "properties": {
        "region": {
          "type": "string"
        },
        "foundationModel": {
          "type": "string"
        },
        "iac": {
          "type": "string"
        },
        "lambdaRuntime": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "region",
        "foundationModel",
        "iac",
        "lambdaRuntime"
      ]
    },
    "AgentKitLocalConfig": {
      "properties": {
        "transport": {
          "type": "string"
        },
        "port": {
          "type": "integer"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "transport"
      ]
    },
    "AutoGenConfig": {
      "properties": {
        "model": {
          "type": "string"
        },
        "humanInputMode": {
          "type": "string"
        },
        "maxConsecutiveAutoReply": {
          "type": "integer"
        },
        "codeExecutionConfig": {
          "$ref": "#/$defs/CodeExecutionConfig"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "ClaudeCodeConfig": {
      "properties": {
        "agentDir": {
          "type": "string"
        },
        "format": {
          "type": "string"
        },
        "team_mode": {
          "type": "string",
          "enum": ["subagent", "team"],
          "default": "subagent",
          "description": "Whether to use subagents or agent teams"
        },
        "teammate_mode": {
          "type": "string",
          "enum": ["in-process", "tmux", "auto"],
          "default": "auto",
          "description": "Display mode for agent teams"
        },
        "enable_teams": {
          "type": "boolean",
          "default": false,
          "description": "Set CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=1"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "agentDir",
        "format"
      ]
    },
    "CodeExecutionConfig": {
      "properties": {
        "workDir": {
          "type": "string"
        },
        "useDocker": {
          "type": "boolean"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "CrewAIConfig": {
      "properties": {
        "model": {
          "type": "string"
        },
        "verbose": {
          "type": "boolean"
        },
        "memory": {
          "type": "boolean"
        },
        "processType": {
          "type": "string"
        },
        "maxIterations": {
          "type": "integer"
        },
        "allowDelegation": {
          "type": "boolean",
          "default": true,
          "description": "Enable agent delegation in CrewAI"
        },
        "managerLlm": {
          "type": "string",
          "description": "Model for manager agent in hierarchical process"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "Deployment": {
      "properties": {
        "$schema": {
          "type": "string"
        },
        "team": {
          "type": "string"
        },
        "targets": {
          "items": {
            "$ref": "#/$defs/Target"
          },
          "type": "array"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "team",
        "targets"
      ]
    },
    "DeploymentMode": {
      "type": "string",
      "enum": [
        "single-process",
        "multi-process",
        "distributed",
        "serverless"
      ],
      "description": "Deployment execution mode"
    },
    "DockerComposeConfig": {
      "properties": {
        "networkMode": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "GeminiCLIConfig": {
      "properties": {
        "model": {
          "type": "string"
        },
        "configDir": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "KiroCLIConfig": {
      "properties": {
        "pluginDir": {
          "type": "string"
        },
        "format": {
          "type": "string"
        },
        "prefix": {
          "type": "string",
          "description": "Prefix applied to agent names, filenames, and steering files for namespace isolation"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "KubernetesConfig": {
      "properties": {
        "namespace": {
          "type": "string"
        },
        "helmChart": {
          "type": "boolean"
        },
        "imageRegistry": {
          "type": "string"
        },
        "resourceLimits": {
          "$ref": "#/$defs/ResourceLimits"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "namespace",
        "helmChart"
      ]
    },
    "LoggingConfig": {
      "properties": {
        "level": {
          "type": "string"
        },
        "format": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "MetricsConfig": {
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "exporter": {
          "type": "string"
        },
        "endpoint": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "ObservabilityConfig": {
      "properties": {
        "tracing": {
          "$ref": "#/$defs/TracingConfig"
        },
        "metrics": {
          "$ref": "#/$defs/MetricsConfig"
        },
        "logging": {
          "$ref": "#/$defs/LoggingConfig"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "Platform": {
      "type": "string",
      "enum": [
        "claude-code",
        "gemini-cli",
        "kiro-cli",
        "adk-go",
        "crewai",
        "autogen",
        "aws-agentcore",
        "aws-eks",
        "azure-aks",
        "gcp-gke",
        "kubernetes",
        "docker-compose",
        "agentkit-local"
      ],
      "description": "Supported deployment platform"
    },
    "Priority": {
      "type": "string",
      "enum": [
        "p1",
        "p2",
        "p3"
      ],
      "description": "Deployment priority level",
      "default": "p2"
    },
    "ResourceLimits": {
      "properties": {
        "cpu": {
          "type": "string"
        },
        "memory": {
          "type": "string"
        },
        "gpu": {
          "type": "integer"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "RetryPolicy": {
      "properties": {
        "max_attempts": {
          "type": "integer"
        },
        "backoff": {
          "type": "string"
        },
        "initial_delay": {
          "type": "string"
        },
        "max_delay": {
          "type": "string"
        },
        "retryable_errors": {
          "items": {
            "type": "string"
          },
          "type": "array"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "RuntimeConfig": {
      "properties": {
        "defaults": {
          "$ref": "#/$defs/StepRuntime"
        },
        "steps": {
          "additionalProperties": {
            "$ref": "#/$defs/StepRuntime"
          },
          "type": "object"
        },
        "observability": {
          "$ref": "#/$defs/ObservabilityConfig"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "StepRuntime": {
      "properties": {
        "timeout": {
          "type": "string"
        },
        "retry": {
          "$ref": "#/$defs/RetryPolicy"
        },
        "condition": {
          "type": "string"
        },
        "concurrency": {
          "type": "integer"
        },
        "resources": {
          "$ref": "#/$defs/ResourceLimits"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "Target": {
      "properties": {
        "name": {
          "type": "string"
        },
        "platform": {
          "$ref": "#/$defs/Platform"
        },
        "mode": {
          "$ref": "#/$defs/DeploymentMode"
        },
        "priority": {
          "$ref": "#/$defs/Priority"
        },
        "output": {
          "type": "string"
        },
        "runtime": {
          "$ref": "#/$defs/RuntimeConfig"
        },
        "claudeCode": {
          "$ref": "#/$defs/ClaudeCodeConfig"
        },
        "geminiCli": {
          "$ref": "#/$defs/GeminiCLIConfig"
        },
        "kiroCli": {
          "$ref": "#/$defs/KiroCLIConfig"
        },
        "adkGo": {
          "$ref": "#/$defs/ADKGoConfig"
        },
        "crewai": {
          "$ref": "#/$defs/CrewAIConfig"
        },
        "autogen": {
          "$ref": "#/$defs/AutoGenConfig"
        },
        "awsAgentCore": {
          "$ref": "#/$defs/AWSAgentCoreConfig"
        },
        "kubernetes": {
          "$ref": "#/$defs/KubernetesConfig"
        },
        "dockerCompose": {
          "$ref": "#/$defs/DockerComposeConfig"
        },
        "agentKitLocal": {
          "$ref": "#/$defs/AgentKitLocalConfig"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "name",
        "platform"
      ]
    },
    "TracingConfig": {
      "properties": {
        "enabled": {
          "type": "boolean"
        },
        "exporter": {
          "type": "string"
        },
        "endpoint": {
          "type": "string"
        },
        "sample_rate": {
          "type": "number"
        }
      },
      "additionalProperties": false,
      "type": "object"
    }
  },
  "title": "Multi-Agent Spec - Deployment Definition",
  "description": "Schema for defining deployment targets for multi-agent systems"
}